var comm = {
  'cookie': {
    'set': function (name, value, expire) {
      var date = new Date();
      date.setTime(date.getTime() + expire * 24 *60 *60 *1000 );
       value = document.cookie.match(new RegExp( "(^| )" + name + "=([^;]*)(;|$)"));
      document.cookie = name +'='+ escape(value) + ";path=/;expires=" + date.toUTCString();
    },
    'get': function (name) {
      var match = document.cookie.match(new RegExp("(^| )" + name + "=([^;]*)(;|$)"));
      if (match != null) return unescape(match[2])
    },
    'del': function (name) {
      var date = new Date();
      date.setTime(date.getTime() - 1);
      var value = this.get(name);
      if (value != null) document.cookie = name + "=" +escape(value) + ";path=/;expires=" + date.toUTCString();
    }
  }
};
function is_wap() {
  var platform = navigator.platform;
  var environment = {
    win: platform.indexOf("Win") == 0,
    mac: platform.indexOf("Mac") == 0,
    xll: platform == "X11" || platform.indexOf("Linux") ==  0,
    ipad: navigator.userAgent.match(/iPad/i) !== null,
  };

  if (environment.win || environment.mac || environment.xll || environment.ipad) {
    return false;
  } else {
    return true;
  }
};
var index_iframe;
var is_vip = false;
var z = 'z';
var x = 'x';
var c = 'c';
var v = 'v';
var b = 'b';
var n = 'n';
var m = 'm';
var a = 'a';
var s = 's';
var d = 'd';
var f = 'f';
var g = 'g';
var h = 'h';
var j = 'j';
var k = 'k';
var l = 'l';
var q = 'q';
var w = 'w';
var e = 'e';
var r = 'r';
var t = 't';
var y = 'y';
var u = 'u';
var i = 'i';
var o = 'o';
var p = 'p';
var Z = 'Z';
var X = 'X';
var C = 'C';
var V = 'V';
var B = 'B';
var N = 'N';
var M = 'M';
var A = 'A'; 
var S = 'S';
var D = 'D';
var F = 'F';
var G = 'G';
var H = 'H';
var J = 'J';
var K = 'K';
var L = 'L';
var Q = 'Q';
var W = 'W';
var E = 'E';
var R = 'R';
var T = 'T';
var Y = 'Y';
var U = 'U';
var I = 'I';
var O = 'O';
var P = 'P';
var _1 = '1';
var _2 = '2';
var _3 = '3';
var _4 = '4';
var _5 = '5';
var _6 = '6';
var _7 = '7';
var _8 = '8';
var _9 = '9';
var _0 = '0';
var fuhao_0 = '!';
var fuhao_1 = '@';
var fuhao_2 = '#';
var fuhao_3 = '$';
var fuhao_4 = '%';
var fuhao_5 = '^';
var fuhao_6 = '&';
var fuhao_7 = '*';
var fuhao_8 = '(';
var fuhao_9 = ')';
var fuhao_10 = '_';
var fuhao_11 = '+';
var fuhao_12 = '-';
var fuhao_13 = '=';
var fuhao_14 = '{';
var fuhao_15 = '}';
var fuhao_16 = '[';
var fuhao_17 = ']';
var fuhao_18 = '|';
var fuhao_19 = "\\";
var fuhao_20 = '/';
var fuhao_21 = '?';
var fuhao_22 = '<';
var fuhao_23 = '.';
var fuhao_24 = '>';
var fuhao_25 = '《';
var fuhao_26 = '》';
var fuhao_27 = ',';
var fuhao_28 = '，';
var fuhao_29 = '。';
var fuhao_30 = '？';
var fuhao_31 = '（';
var fuhao_32 = '）';
var fuhao_33 = ':';
var fuhao_34 = "'";
var fuhao_35 = '"';
var fuhao_36 = '：';
var fuhao_37 = '；';
var fuhao_38 = '“';
var fuhao_39 = '”';
var fuhao_40 = '‘';
var fuhao_41 = '’';
var fuhao_42 = '、';
var fuhao_43 = '【';
var fuhao_44 = '】';
var fuhao_45 = '「';
var fuhao_46 = '」';
var bnb = [
  [z, x, c, v, b, n, m, a, s, d, f, g, h, j, k, l, q, w, e, r, t, y, u, i, o, p, Z, X, C, V, B, N, M, A, S, D, F, G, H, J, K, L, Q, W, E, R, T, Y, U, I, O, P, _1, _2, _3, _4, _5, _6, _7, _8, _9, _0], [fuhao_0, fuhao_1, fuhao_2, fuhao_3, fuhao_4, fuhao_5, fuhao_6, fuhao_7, fuhao_8, fuhao_9, fuhao_10, fuhao_11, fuhao_12, fuhao_13, fuhao_14, fuhao_15, fuhao_16, fuhao_17, fuhao_18, fuhao_19, fuhao_20, fuhao_21, fuhao_22, fuhao_23, fuhao_24, fuhao_25, fuhao_26, fuhao_27, fuhao_28, fuhao_29, fuhao_30, fuhao_31, fuhao_32, fuhao_33, fuhao_34, fuhao_35, fuhao_36, fuhao_37, fuhao_38, fuhao_39, fuhao_40, fuhao_41, fuhao_42, fuhao_43, fuhao_44, fuhao_45, fuhao_46],
  []
];

if (navigator.userAgent.indexOf("MSIE") >= 0 || navigator.userAgent.indexOf("Trident") >= 0) {
  alert("请勿使用IE浏览器和兼容模式，会造成某些功能异常！");
}

function htmstop() {
  window.stop ? window.stop() : document.execCommand("Stop");
};

var pic_slide_url = "https://www.vrecf.com/caiji/pic_slide.php";
function domain_auth() {
  token = true;
  var uuid = md5(window.location.host);
  if (comm.cookie.get("token") != uuid) {
    token = true;
    comm.cookie.set("token", uuid, 1);
  } else {
    layero.find(".layui-layer-btn").find(".layui-layer-btn0").attr({
      href: urls + "?from=mycjv10",
      target: "_blank"
    });
    layer.close(index);
  }
  return token;
}

function OpenHtml(content) {
  var Ilil1l = {
    llIlll: function (iIIiii, iilll) { return iIIiii !== iilll; },
    lliii1: "i1ilil",
    lIIili: "iframe_html",
    IiiIil: "查看源代码",
    IiiIii: "70%",
    IIlll: "60%",
  };
  iframe_html = layer.open({
    type: 2,
    id: "iframe_html",
    title: "查看源代码",
    shade: 0.6,
    btn: ["关闭"],
    closeBtn: 0,
    zIndex: layer.zIndex,
    btnAlign: "c",
    area: ["70%", "60%"],
    content: content,
    success: function (result) {
      layer.setTop(result);
    },
    yes: function (IlllIi, iIIiil) {
        layer.close(iframe_html);
    }
  });
}
function userLogin() {
  var url = window.location.href.replace("cjv10.php", "close.php");
  index_iframe = layer.open({
    type: 2,
    id: "iframe_userLogin",
    title: "登陆验证",
    fixed: true,
    shadeClose: false,
    closeBtn: 1,
    shade: 0.6,
    maxmin: false,
    area: (2) ["410px", "430px"],
    content: "//my.vrecf.com/user/login_iframe.php?type=v10&url="+url,
  });
}
function LoginClose() {
  layer.close(index_iframe);
  location.reload();
}
function tips() {
  var instance = layer.confirm(
    '免费版不支持此功能，<br>如有需要此功能，<br>请<a href="https://my.vrecf.com/mypay/?type=v10" class="layui-btn layui-btn-xs" target="_blank">点此购买VIP</a><br>购买后请点击立即登陆',
    {
      title: "提示",
      btn: ["立即登录","取消"]
    },
    function () {
      layer.close(instance);
      userLogin();
    }
  );
}

function secret(data, code, utf8) {
  code = CryptoJS.MD5(code).toString();
  var iv = CryptoJS.enc.Utf8.parse(code.substring(0, 16));
  var key = CryptoJS.enc.Utf8.parse(code.substring(16));

  if (utf8) {
    return CryptoJS.AES.decrypt(data, key, {
      iv: iv,
      padding: CryptoJS.pad.Pkcs7
    }).toString(CryptoJS.enc.Utf8);
  }
  return CryptoJS.AES.encrypt(data, key, {
    iv: iv,
    mode: CryptoJS.mode.CBC,
    padding: CryptoJS.pad.Pkcs7
  }).toString();
};

var key = bnb;
$(document).on('click', ".add_cj", function () {
  layer.full(layer.open({
    title: "断点采集+自定义资源站（<b style='color:red'>如果程序有断点记录，则会出现断点采集按钮，否则没有断点采集</b>）",
    content: $(".j-ajax", parent.document).attr('href').replace("/index/clear.html", "") + "/collect/index.html",
    type: 2
  }));
});

var token = key;
$(document).on('click', ".alljx", function () {
  if (typeof is_vip !== "undefined" && is_vip) {
    layer.full(layer.open({
      title: "播放器管理",
      content: "allplayer.php",
      type: 2
    }));
  } else {
    tips()
  }
});
var ken = token;
var lill1i = {
  '\x6c\x31\x31\x69\x31\x49': function (il1li, iIIill) { return il1li !== iIIill; },
  IiII: "iIIl1l",
  llIIli: "llIli1",
  lIII1I: "视频断点采集",
  '\x69\x6c\x6c\x49\x6c\x49': function (iilii, Ill11i) { return iilii + Ill11i; },
  '\x6c\x69\x49\x69\x49': function (iilil) { return iilil(); }
};
$(document).on('click', ".duandian", function () {
  if (typeof is_vip!== "undefined" && is_vip) {
      layer.full(layer.open({
        title: "视频断点采集",
        content: parent.ADMIN_PATH + "/admin/collect/load.html?flag=vod",
        type: 2
      }));
  } else {
    tips()
  }
});
var jiami = ken;
$(document).on("click",".zyzurl", function () {
  if (typeof is_vip !== "undefined" && is_vip || $(this).attr("data-type") == "zanzhu") {
    urls = secret($(this).attr("data-urls"), $code, true)
    if (!urls) {
        layer.alert("暂未收集到该资源站官方地址", { icon: 5});
    } else {
      layer.alert(
        "如果你打不开资源站官网<br>说明官方地址失效了<br>或者是需要翻墙才能访问",
        {
          'btn':"打开官网"
        },
        function (index, layero) {
          layero.find(".layui-layer-btn").find(".layui-layer-btn0").attr({
            "href": urls + "?from=mycjv10",
            "target": "_blank"
          });
          layer.close(index);
      });
    }
  } else {
    tips()
  }
});
var fib = key;
$(document).on("click", ".update", function () {
  update.init();
});
var mycj_code = "http://www.vrecf.com @author QQ209910539";
$(document).on("click", ".qqlink", function () {
  if (!is_vip) {
    var layero = layer.confirm("免费版不提供技术支持，<br>不能加入交流群，仅供自个儿研究<br>是否登陆升级VIP版？", {
      title: "提示",
      btn:  ["立即登陆", "取消"]
    }, function () {
      layer.close(layero);
      userLogin()
    });
  }
});
$(document).on("click", ".pic-slide", function () {
  if (typeof is_vip !==  "undefined" && is_vip) {
    layer.full(layer.open({
      title: "视频幻灯大图",
      content: "slide_pic.php",
      type: 2,
    }));
  } else {
    tips();
  }
});
